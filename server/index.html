<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
		<!--<link rel="stylesheet" type="text/css" href="player.css">-->
		<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
		<script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
		<script src="/socket.io/socket.io.js"></script>
		<script>
			var socket = io('http://localhost:8000');
			socket.on('news', function (data) {
				var logDiv = document.getElementById("log");
					logDiv.innerHTML = data.message;
			});
	
			socket.on('lista', function (list) {
				var logDiv = document.getElementById("list");
					logDiv.innerHTML = putInTable(list);
			});
		  
			socket.on('current', function (current) {
				printTitle(current.name)
			});
			
			function stop() {
				socket.emit('stop');
			}

			function start() {
				socket.emit('play', document.getElementById("source").value);
			}
			
			function requestList() {
				socket.emit('list');
			}
			
			function putInTable(list) {
				table="<ul class=\"list-group\">";
				for(var i = 0; i < list.length; i++) {
					if(list[i].status == "PLAYING")
						table += "<li class=\"list-group-item active\">"
					else
						table += "<li class=\"list-group-item\">"
					table += list[i].name
					table += "</li>";
				}
				table += "</ul>"
				return table;
			}
			
		</script>
		<script>
			var IP_ADDRESS = "192.168.0.105";

			function checkPlayer() {
				if(isPlayerRunning())
					printTitle(getSongInfo());
				else
					printTitle("Nem megy semmi");
			}

			function printTitle(text) {
					document.getElementById('title').innerHTML = "<p>" + text + "</p>";
			}

			function getSongInfo() {
				//return sendCommand("songname");
			}

			function isPlayerRunning() {
				//return sendCommand("checkstatus") == "1";
			}

			function sendCommand(ID) {
				var xmlHttp = new XMLHttpRequest();
				xmlHttp.open( "GET", "http://" + IP_ADDRESS + "/player.php?command=" + ID, false );
				xmlHttp.send( null );
				var resp = xmlHttp.responseText;
				//document.getElementById('debug').innerHTML = resp;
				return resp;
			}

			$(document).ready(function() {
				checkPlayer();
				requestList();
			});
		</script>
	</head>
	<body>
		<input type="text" id="source" value="test.mp3">
		<button onclick="start()">Start</button>
		<button onclick="stop()">Stop</button>
		<div id="log">
		</div>
		<div id="player" class="container" role="main">
			<div id="title" class="well"></div>
			<p>
				<div class="btn-group">
					<button type="button" class="btn btn-primary btn-lg"  onclick="sendCommand(this.id)" id="seek_minus_600"><span class="glyphicon glyphicon-fast-backward"></span></button>
					<button type="button" class="btn btn-primary btn-lg"  onclick="sendCommand(this.id)" id="seek_minus_30"><span class="glyphicon glyphicon-backward"></span></button>
					<button type="button" class="btn btn-primary btn-lg"  onclick="sendCommand(this.id)" id="pause"><span class="glyphicon glyphicon glyphicon-play"></span></button>
					<button type="button" class="btn btn-primary btn-lg"  onclick="sendCommand(this.id)" id="exit"><span class="glyphicon glyphicon glyphicon-stop"></span></button>
					<button type="button" class="btn btn-primary btn-lg"  onclick="sendCommand(this.id)" id="seek_plus_30"><span class="glyphicon glyphicon-forward"></span></button>
					<button type="button" class="btn btn-primary btn-lg"  onclick="sendCommand(this.id)" id="seek_plus_600"><span class="glyphicon glyphicon-fast-forward"></span></button>
				</div>
			</p>
			<p>
				<div class="btn-group">
					<button type="button" class="btn btn-primary btn-lg"  onclick="sendCommand(this.id)" id="decrease_volume"><span class="glyphicon glyphicon-volume-down"></span></button>
					<button type="button" class="btn btn-primary btn-lg"  onclick="sendCommand(this.id)" id="increase_volume"><span class="glyphicon glyphicon-volume-up"></span></button>
				</div>
			</p>
			<div id="list"></div>
	</body>
</html>
